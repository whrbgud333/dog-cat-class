# 🐶🐱 강아지 vs 고양이 분류기 (Dog vs Cat Classifier)

이 프로젝트는 딥러닝 모델(Xception)을 이용하여 업로드된 이미지가 강아지인지 고양이인지 분류하는 웹 서비스입니다. 
Gradio 라이브러리를 사용하여 사용자 친화적인 웹 인터페이스를 제공합니다.

## 🚀 주요 파일 설명: `web_app.py`
이 파일은 웹 서비스를 실행하는 핵심 스크립트입니다. 주요 기능과 동작 과정은 다음과 같습니다.

### 1. 라이브러리 임포트
- `gradio`, `numpy`, `tensorflow`, `PIL.Image`를 사용하여 웹 인터페이스 구축, 데이터 배열 처리, 딥러닝 모델 구동 및 이미지 전처리를 수행합니다.

### 2. 모델 로드 및 초기화
- 사전 학습된 모델인 `best_model_xception.keras` 파일을 불러옵니다.
- 모델의 입력 크기(input shape)를 동적으로 확인하며, 확인이 실패할 경우 Xception 모델의 기본 크기인 `(299, 299)`로 설정합니다.

### 3. 이미지 예측 함수 (`predict_image`)
사용자가 이미지를 업로드하면 다음 과정들을 거쳐 예측 결과를 반환합니다.
- **이미지 크기 조정**: 모델의 예상 입력 크기(기본 299x299)로 이미지 사이즈를 변경합니다.
- **채널 변환**: 흑백(1채널)이거나 투명도(RGBA, 4채널)가 있는 이미지를 RGB(3채널) 형식으로 변환합니다.
- **전처리 (Preprocessing)**: `tf.keras.applications.xception.preprocess_input` 함수를 이용해 픽셀 값을 -1과 1 사이로 정규화합니다.
- **분류 예측**: 모델 구성(이진 탐색 여부 등)을 파악하고 강아지와 고양이일 확률을 계산하여 백분율(Confidence) 형태로 반환합니다.

### 4. 웹 UI 구성 (Gradio 인터페이스)
- 사용자가 직관적으로 이미지를 입력하고 결과를 확인할 수 있도록 화면이 분할된 UI(좌측: 이미지 업로드, 우측: 예측 결과 표시)를 만듭니다.
- 시각적으로 깔끔하고 모던한 UI를 위해 Gradio의 `Soft` 테마를 적용하였습니다.

## 🛠 실행 방법
터미널(또는 명령 프롬프트)에서 다음 명령어를 실행하여 웹 서버를 엽니다:
```bash
python web_app.py
```
명령어를 실행하면 웹 브라우저에서 사용할 수 있는 로컬 링크(예: `http://127.0.0.1:7860`)가 출력되어 브라우저에서 사용할 수 있습니다.
